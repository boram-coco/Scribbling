<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="김보람">
<meta name="dcterms.date" content="2023-06-09">

<title>Scribbling - AS HW4_5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Scribbling</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../about.html" aria-current="page">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">AS HW4_5</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block">AS HW4_5</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Applied statistics</div>
                <div class="quarto-category">homework</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>김보람 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 9, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../about.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Posts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/학회.html" class="sidebar-item-text sidebar-link">2023년 학회 발표 준비</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/AS4_5.html" class="sidebar-item-text sidebar-link active">AS HW4_5</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/논문.html" class="sidebar-item-text sidebar-link">GNN</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/tensor basic.html" class="sidebar-item-text sidebar-link">Tensor Basic</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/2022_04_23_중간고사예상문제.html" class="sidebar-item-text sidebar-link">중간고사 예상문제</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Hadamangeo</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/hadamangeo/graph4-3.html" class="sidebar-item-text sidebar-link">CH4. 지도 그래프 학습(그래프 정규화 방법)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/hadamangeo/Czech-banking-customer-trans-analysis.html" class="sidebar-item-text sidebar-link">Czech Bank’s Financial Data Analysis. Moving from gut feeling to data-driven decisions.</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/hadamangeo/Hands-on Graph Neural Networks with PyTorch &amp; PyTorch Geometric.html" class="sidebar-item-text sidebar-link">Hands-on Graph Neural Networks with PyTorch &amp; PyTorch Geometric</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/hadamangeo/VAE.html" class="sidebar-item-text sidebar-link">VAE(-ing)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/hadamangeo/coin prediction.html" class="sidebar-item-text sidebar-link">미래 예측 데이터 분석(비트코인 시세 예측)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/hadamangeo/ml with python 8.html" class="sidebar-item-text sidebar-link">지도 학습</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">사기거래</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/사기거래/graph8(frac.html" class="sidebar-item-text sidebar-link">CH8. 신용카드 거래에 대한 그래프 분석(frac=0.3)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/사기거래/낙서.html" class="sidebar-item-text sidebar-link">낙서</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/사기거래/교수님.html" class="sidebar-item-text sidebar-link">분석</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/사기거래/사기거래 날짜 230602.html" class="sidebar-item-text sidebar-link">사기거래 날짜 wmatrix</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/사기거래/교수님 data(re).html" class="sidebar-item-text sidebar-link">사기거래 변형코드</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/사기거래/2023-05-24-try2변형.html" class="sidebar-item-text sidebar-link">사기거래(교수님 코드-변형)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/사기거래/교수님 data(원본).html" class="sidebar-item-text sidebar-link">사기거래(교수님)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/사기거래/9999.html" class="sidebar-item-text sidebar-link">사기거래(교수님과 같이 정리중)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../posts/사기거래/교수님 data(time12).html" class="sidebar-item-text sidebar-link">사기거래(설명변수 time추가)</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#ref" id="toc-ref" class="nav-link active" data-scroll-target="#ref">ref</a></li>
  <li><a href="#import" id="toc-import" class="nav-link" data-scroll-target="#import">import</a></li>
  <li><a href="#데이터셋" id="toc-데이터셋" class="nav-link" data-scroll-target="#데이터셋">데이터셋</a></li>
  <li><a href="#회귀직선적합" id="toc-회귀직선적합" class="nav-link" data-scroll-target="#회귀직선적합">회귀직선적합</a>
  <ul class="collapse">
  <li><a href="#model1원본" id="toc-model1원본" class="nav-link" data-scroll-target="#model1원본">model1(원본)</a></li>
  <li><a href="#model2vif-10-이상인-변수-제거" id="toc-model2vif-10-이상인-변수-제거" class="nav-link" data-scroll-target="#model2vif-10-이상인-변수-제거">model2(Vif 10 이상인 변수 제거)</a></li>
  </ul></li>
  <li><a href="#다중공산성-해결-방법" id="toc-다중공산성-해결-방법" class="nav-link" data-scroll-target="#다중공산성-해결-방법">다중공산성 해결 방법</a>
  <ul class="collapse">
  <li><a href="#정규화" id="toc-정규화" class="nav-link" data-scroll-target="#정규화">정규화</a></li>
  <li><a href="#변수선택" id="toc-변수선택" class="nav-link" data-scroll-target="#변수선택">변수선택</a>
  <ul class="collapse">
  <li><a href="#model3aic" id="toc-model3aic" class="nav-link" data-scroll-target="#model3aic">model3(AIC)</a></li>
  </ul></li>
  <li><a href="#pca주성분분석" id="toc-pca주성분분석" class="nav-link" data-scroll-target="#pca주성분분석">PCA(주성분분석)</a></li>
  </ul></li>
  <li><a href="#해볼것" id="toc-해볼것" class="nav-link" data-scroll-target="#해볼것">해볼것</a></li>
  <li><a href="#능형회귀" id="toc-능형회귀" class="nav-link" data-scroll-target="#능형회귀">능형회귀</a>
  <ul class="collapse">
  <li><a href="#glm" id="toc-glm" class="nav-link" data-scroll-target="#glm">glm</a></li>
  </ul></li>
  <li><a href="#번외-war을-y로" id="toc-번외-war을-y로" class="nav-link" data-scroll-target="#번외-war을-y로">번외 (WAR을 y로)</a></li>
  <li><a href="#feedback" id="toc-feedback" class="nav-link" data-scroll-target="#feedback">feedback</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>야구 데이터</p>
<ol type="1">
<li><p>데이터 소개</p></li>
<li><p>데이터 lm 돌리기</p></li>
<li><p>glm도 돌려보자. 이게 뭐였뜨라..</p></li>
<li><p>다중공산성을 확인해보자</p></li>
<li><p>AIC를 이용해 최종모형을 선택하고, VIF를 비교해보자</p></li>
</ol>
<p>로지스틱을 돌릴만한 데이터가 ,, 야구에 있나?</p>
<section id="ref" class="level1">
<h1>ref</h1>
<p><a href="https://github.com/yoonkt200/python-data-analysis/blob/master/data/picher_stats_2017.csv">python-data-analysis data</a></p>
<p><a href="http://www.statiz.co.kr/">Data Source</a></p>
</section>
<section id="import" class="level1">
<h1>import</h1>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(MASS) <span class="co">#lm.ridge </span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(car) <span class="co">#vif</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(glmnet) <span class="co">#Ridge, Lasso</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData

Loading required package: Matrix

Loaded glmnet 4.1-7
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>get_high_vif_variables <span class="ot">&lt;-</span> <span class="cf">function</span>(data, threshold) {</span>
<span id="cb3-2"><a href="#cb3-2"></a>  vif_values <span class="ot">&lt;-</span> <span class="fu">vif</span>(data)</span>
<span id="cb3-3"><a href="#cb3-3"></a>  high_vif_variables <span class="ot">&lt;-</span> <span class="fu">names</span>(vif_values[vif_values <span class="sc">&gt;</span> threshold])</span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">return</span>(high_vif_variables)</span>
<span id="cb3-5"><a href="#cb3-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="데이터셋" class="level1">
<h1>데이터셋</h1>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>picher <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/Dropbox/coco/posts/Applied statistics/picher_stats_2017.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">head</span>(picher)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 22</caption>
<thead>
    <tr><th></th><th scope="col">선수명</th><th scope="col">팀명</th><th scope="col">승</th><th scope="col">패</th><th scope="col">세</th><th scope="col">홀드</th><th scope="col">블론</th><th scope="col">경기</th><th scope="col">선발</th><th scope="col">이닝</th><th scope="col">⋯</th><th scope="col">홈런.9</th><th scope="col">BABIP</th><th scope="col">LOB.</th><th scope="col">ERA</th><th scope="col">RA9.WAR</th><th scope="col">FIP</th><th scope="col">kFIP</th><th scope="col">WAR</th><th scope="col">연봉.2018.</th><th scope="col">연봉.2017.</th></tr>
    <tr><th></th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;chr&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">⋯</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>켈리    </td><td>SK  </td><td>16</td><td> 7</td><td>0</td><td>0</td><td>0</td><td>30</td><td>30</td><td>190.0</td><td>⋯</td><td>0.76</td><td>0.342</td><td>73.7</td><td>3.60</td><td>6.91</td><td>3.69</td><td>3.44</td><td>6.62</td><td>140000</td><td> 85000</td></tr>
    <tr><th scope="row">2</th><td>소사    </td><td>LG  </td><td>11</td><td>11</td><td>1</td><td>0</td><td>0</td><td>30</td><td>29</td><td>185.1</td><td>⋯</td><td>0.53</td><td>0.319</td><td>67.1</td><td>3.88</td><td>6.80</td><td>3.52</td><td>3.41</td><td>6.08</td><td>120000</td><td> 50000</td></tr>
    <tr><th scope="row">3</th><td>양현종  </td><td>KIA </td><td>20</td><td> 6</td><td>0</td><td>0</td><td>0</td><td>31</td><td>31</td><td>193.1</td><td>⋯</td><td>0.79</td><td>0.332</td><td>72.1</td><td>3.44</td><td>6.54</td><td>3.94</td><td>3.82</td><td>5.64</td><td>230000</td><td>150000</td></tr>
    <tr><th scope="row">4</th><td>차우찬  </td><td>LG  </td><td>10</td><td> 7</td><td>0</td><td>0</td><td>0</td><td>28</td><td>28</td><td>175.2</td><td>⋯</td><td>1.02</td><td>0.298</td><td>75.0</td><td>3.43</td><td>6.11</td><td>4.20</td><td>4.03</td><td>4.63</td><td>100000</td><td>100000</td></tr>
    <tr><th scope="row">5</th><td>레일리  </td><td>롯데</td><td>13</td><td> 7</td><td>0</td><td>0</td><td>0</td><td>30</td><td>30</td><td>187.1</td><td>⋯</td><td>0.91</td><td>0.323</td><td>74.1</td><td>3.80</td><td>6.13</td><td>4.36</td><td>4.31</td><td>4.38</td><td>111000</td><td> 85000</td></tr>
    <tr><th scope="row">6</th><td>피어밴드</td><td>KT  </td><td> 8</td><td>10</td><td>0</td><td>0</td><td>0</td><td>26</td><td>26</td><td>160.0</td><td>⋯</td><td>1.12</td><td>0.289</td><td>76.1</td><td>3.04</td><td>6.52</td><td>4.42</td><td>4.32</td><td>3.94</td><td> 85000</td><td> 35000</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">subset</span>(picher, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(팀명,선수명))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>dt2018 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">new_col =</span> dt<span class="sc">$</span>연봉.<span class="fl">2018.</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>dt2017 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">new_col =</span> dt<span class="sc">$</span>연봉.<span class="fl">2017.</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">subset</span>(picher, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(연봉.<span class="fl">2017.</span>,연봉.<span class="fl">2018.</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dt, <span class="at">new_col =</span> dt2017)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="fu">names</span>(dt)[<span class="fu">length</span>(<span class="fu">names</span>(dt))] <span class="ot">&lt;-</span> <span class="st">"연봉.2017."</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dt, <span class="at">new_col =</span> dt2018)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="fu">names</span>(dt)[<span class="fu">length</span>(<span class="fu">names</span>(dt))] <span class="ot">&lt;-</span> <span class="st">"연봉.2018."</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">subset</span>(picher, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(팀명,선수명))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="회귀직선적합" class="level1">
<h1>회귀직선적합</h1>
<section id="model1원본" class="level2">
<h2 class="anchored" data-anchor-id="model1원본">model1(원본)</h2>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(연봉.<span class="fl">2018.</span> <span class="sc">~</span> ., dt)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = 연봉.2018. ~ ., data = dt)

Residuals:
   Min     1Q Median     3Q    Max 
-46529  -2418    424   2649  47773 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.513e+04  1.826e+04   0.829   0.4087    
승           1.004e+03  5.375e+02   1.869   0.0639 .  
패          -1.836e+02  5.504e+02  -0.334   0.7392    
세          -2.112e+01  2.713e+02  -0.078   0.9381    
홀드        -1.817e+01  3.161e+02  -0.057   0.9542    
블론         4.535e+02  7.610e+02   0.596   0.5522    
경기        -1.760e+02  1.456e+02  -1.209   0.2289    
선발        -6.719e+02  4.616e+02  -1.456   0.1479    
이닝         7.425e+01  1.156e+02   0.642   0.5217    
삼진.9      -4.603e+02  2.349e+03  -0.196   0.8449    
볼넷.9       1.194e+03  2.256e+03   0.529   0.5976    
홈런.9       4.874e+03  1.413e+04   0.345   0.7306    
BABIP       -9.997e+03  1.486e+04  -0.673   0.5022    
LOB.        -4.350e+01  1.299e+02  -0.335   0.7382    
ERA         -7.413e+01  5.693e+02  -0.130   0.8966    
RA9.WAR     -7.584e+02  1.487e+03  -0.510   0.6109    
FIP         -6.436e+03  4.477e+04  -0.144   0.8859    
kFIP         3.805e+03  3.593e+04   0.106   0.9158    
WAR          8.559e+03  1.789e+03   4.783 4.55e-06 ***
연봉.2017.   8.755e-01  4.444e-02  19.698  &lt; 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 9198 on 132 degrees of freedom
Multiple R-squared:  0.9228,    Adjusted R-squared:  0.9116 
F-statistic: 82.99 on 19 and 132 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">vif</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class="dl-inline"><dt>승</dt><dd>7.69934669638176</dd><dt>패</dt><dd>5.30032799820878</dd><dt>세</dt><dd>3.03718565968123</dd><dt>홀드</dt><dd>3.63605161357374</dd><dt>블론</dt><dd>2.75956034802692</dd><dt>경기</dt><dd>14.2011271199637</dd><dt>선발</dt><dd>36.1601878733279</dd><dt>이닝</dt><dd>60.3244538179009</dd><dt>삼진.9</dt><dd>78.7161704892493</dd><dt>볼넷.9</dt><dd>50.7257985016107</dd><dt>홈런.9</dt><dd>368.399308168573</dd><dt>BABIP</dt><dd>3.11936893312554</dd><dt>LOB.</dt><dd>4.04602533224649</dd><dt>ERA</dt><dd>10.0441738232824</dd><dt>RA9.WAR</dt><dd>13.4198973515016</dd><dt>FIP</dt><dd>12525.2424059086</dd><dt>kFIP</dt><dd>9046.04880487446</dd><dt>WAR</dt><dd>9.99177856816849</dd><dt>연봉.2017.</dt><dd>2.21186942564398</dd></dl>
</div>
</div>
<div class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>threshold <span class="ot">&lt;-</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>high_vif_vars <span class="ot">&lt;-</span> <span class="fu">get_high_vif_variables</span>(model1, threshold)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">print</span>(high_vif_vars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "경기"    "선발"    "이닝"    "삼진.9"  "볼넷.9"  "홈런.9"  "ERA"    
 [8] "RA9.WAR" "FIP"     "kFIP"   </code></pre>
</div>
</div>
<div class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>threshold <span class="ot">&lt;-</span> <span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>high_vif_vars <span class="ot">&lt;-</span> <span class="fu">get_high_vif_variables</span>(model1, threshold)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="fu">print</span>(high_vif_vars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "선발"   "이닝"   "삼진.9" "볼넷.9" "홈런.9" "FIP"    "kFIP"  </code></pre>
</div>
</div>
<div class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">pairs</span>(dt,<span class="at">panel=</span>panel.smooth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="AS4_5_files/figure-html/cell-25-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>수치형 데이터들끼리의 상관계수 확인..</li>
</ul>
<div class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>dt_numeric <span class="ot">&lt;-</span> dt[, <span class="fu">sapply</span>(dt, is.numeric)]</span>
<span id="cb22-2"><a href="#cb22-2"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(dt_numeric)</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="fu">print</span>(<span class="fu">round</span>(cor_matrix,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              승    패    세  홀드  블론  경기  선발  이닝 삼진.9 볼넷.9 홈런.9
승          1.00  0.71  0.05  0.09  0.11  0.40  0.77  0.91   0.08  -0.40  -0.12
패          0.71  1.00  0.07  0.10  0.12  0.34  0.77  0.83   0.03  -0.39  -0.06
세          0.05  0.07  1.00  0.11  0.61  0.43 -0.18  0.02   0.17  -0.13  -0.07
홀드        0.09  0.10  0.11  1.00  0.49  0.72 -0.29  0.02   0.19  -0.15  -0.08
블론        0.11  0.12  0.61  0.49  1.00  0.63 -0.26  0.01   0.19  -0.14  -0.06
경기        0.40  0.34  0.43  0.72  0.63  1.00 -0.04  0.38   0.19  -0.36  -0.11
선발        0.77  0.77 -0.18 -0.29 -0.26 -0.04  1.00  0.89  -0.06  -0.31  -0.06
이닝        0.91  0.83  0.02  0.02  0.01  0.38  0.89  1.00   0.04  -0.45  -0.11
삼진.9      0.08  0.03  0.17  0.19  0.19  0.19 -0.06  0.04   1.00   0.11   0.22
볼넷.9     -0.40 -0.39 -0.13 -0.15 -0.14 -0.36 -0.31 -0.45   0.11   1.00   0.30
홈런.9     -0.12 -0.06 -0.07 -0.08 -0.06 -0.11 -0.06 -0.11   0.22   0.30   1.00
BABIP      -0.17 -0.13 -0.09 -0.10 -0.11 -0.24 -0.10 -0.19   0.46   0.28   0.36
LOB.        0.13 -0.02  0.17  0.05  0.10  0.11  0.04  0.10  -0.07  -0.15  -0.27
ERA        -0.27 -0.19 -0.15 -0.16 -0.16 -0.32 -0.16 -0.29   0.26   0.52   0.63
RA9.WAR     0.85  0.60  0.17  0.00  0.01  0.28  0.74  0.85   0.10  -0.40  -0.19
FIP        -0.30 -0.23 -0.20 -0.21 -0.21 -0.35 -0.15 -0.30  -0.15   0.63   0.83
kFIP       -0.31 -0.24 -0.23 -0.24 -0.24 -0.37 -0.14 -0.30  -0.32   0.61   0.74
WAR         0.82  0.63  0.08 -0.04 -0.06  0.20  0.76  0.83   0.15  -0.39  -0.21
연봉.2018.  0.71  0.47  0.21 -0.02  0.10  0.21  0.56  0.66   0.10  -0.33  -0.12
연봉.2017.  0.63  0.43  0.26  0.00  0.15  0.23  0.49  0.59   0.10  -0.33  -0.10
           BABIP  LOB.   ERA RA9.WAR   FIP  kFIP   WAR 연봉.2018. 연봉.2017.
승         -0.17  0.13 -0.27    0.85 -0.30 -0.31  0.82       0.71       0.63
패         -0.13 -0.02 -0.19    0.60 -0.23 -0.24  0.63       0.47       0.43
세         -0.09  0.17 -0.15    0.17 -0.20 -0.23  0.08       0.21       0.26
홀드       -0.10  0.05 -0.16    0.00 -0.21 -0.24 -0.04      -0.02       0.00
블론       -0.11  0.10 -0.16    0.01 -0.21 -0.24 -0.06       0.10       0.15
경기       -0.24  0.11 -0.32    0.28 -0.35 -0.37  0.20       0.21       0.23
선발       -0.10  0.04 -0.16    0.74 -0.15 -0.14  0.76       0.56       0.49
이닝       -0.19  0.10 -0.29    0.85 -0.30 -0.30  0.83       0.66       0.59
삼진.9      0.46 -0.07  0.26    0.10 -0.15 -0.32  0.15       0.10       0.10
볼넷.9      0.28 -0.15  0.52   -0.40  0.63  0.61 -0.39      -0.33      -0.33
홈런.9      0.36 -0.27  0.63   -0.19  0.83  0.74 -0.21      -0.12      -0.10
BABIP       1.00 -0.51  0.73   -0.19  0.25  0.17 -0.08      -0.10      -0.09
LOB.       -0.51  1.00 -0.72    0.29 -0.29 -0.27  0.14       0.13       0.11
ERA         0.73 -0.72  1.00   -0.34  0.65  0.58 -0.26      -0.22      -0.20
RA9.WAR    -0.19  0.29 -0.34    1.00 -0.37 -0.38  0.92       0.74       0.64
FIP         0.25 -0.29  0.65   -0.37  1.00  0.98 -0.39      -0.28      -0.27
kFIP        0.17 -0.27  0.58   -0.38  0.98  1.00 -0.41      -0.30      -0.28
WAR        -0.08  0.14 -0.26    0.92 -0.39 -0.41  1.00       0.79       0.68
연봉.2018. -0.10  0.13 -0.22    0.74 -0.28 -0.30  0.79       1.00       0.93
연봉.2017. -0.09  0.11 -0.20    0.64 -0.27 -0.28  0.68       0.93       1.00</code></pre>
</div>
</div>
</section>
<section id="model2vif-10-이상인-변수-제거" class="level2">
<h2 class="anchored" data-anchor-id="model2vif-10-이상인-변수-제거">model2(Vif 10 이상인 변수 제거)</h2>
<div class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(연봉.<span class="fl">2018.</span> <span class="sc">~</span> .<span class="sc">-</span>경기<span class="sc">-</span>선발<span class="sc">-</span>이닝<span class="sc">-</span>삼진<span class="fl">.9</span><span class="sc">-</span>볼넷<span class="fl">.9</span><span class="sc">-</span>홈런<span class="fl">.9</span><span class="sc">-</span>ERA<span class="sc">-</span>RA9.WAR<span class="sc">-</span>FIP<span class="sc">-</span>kFIP, dt)</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = 연봉.2018. ~ . - 경기 - 선발 - 이닝 - 삼진.9 - 
    볼넷.9 - 홈런.9 - ERA - RA9.WAR - FIP - kFIP, data = dt)

Residuals:
   Min     1Q Median     3Q    Max 
-48657  -1981    511   2303  51073 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  6.432e+03  7.893e+03   0.815   0.4165    
승           4.770e+02  4.061e+02   1.175   0.2421    
패          -7.851e+02  3.525e+02  -2.227   0.0275 *  
세          -1.172e+02  2.150e+02  -0.545   0.5865    
홀드        -1.229e+02  1.973e+02  -0.623   0.5344    
블론         6.340e+02  7.188e+02   0.882   0.3792    
BABIP       -7.810e+03  9.994e+03  -0.781   0.4358    
LOB.        -4.979e+01  7.793e+01  -0.639   0.5239    
WAR          7.298e+03  1.169e+03   6.243 4.67e-09 ***
연봉.2017.   8.846e-01  4.322e-02  20.469  &lt; 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 9149 on 142 degrees of freedom
Multiple R-squared:  0.9178,    Adjusted R-squared:  0.9126 
F-statistic: 176.1 on 9 and 142 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">vif</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class="dl-inline"><dt>승</dt><dd>4.44133840452701</dd><dt>패</dt><dd>2.19787784118271</dd><dt>세</dt><dd>1.9291576101908</dd><dt>홀드</dt><dd>1.43155944990414</dd><dt>블론</dt><dd>2.48814143828698</dd><dt>BABIP</dt><dd>1.42670331782564</dd><dt>LOB.</dt><dd>1.47225296358887</dd><dt>WAR</dt><dd>4.30937396392511</dd><dt>연봉.2017.</dt><dd>2.11357639082776</dd></dl>
</div>
</div>
<ul>
<li><p>model1에서 다중공산성이 높았던 변수들을 제외하고 lm을 돌렸더니, 회귀모형은 유의하게 나왔고 R^2값도 91%로 높게 나왔지만 model1보다는 R^2값이 조금 적게 나왔다.</p></li>
<li><p>다중공산성이 높은 변수를 제외하는 것은 다른 것들도 확인을 해보아야 한다.</p></li>
</ul>
</section>
</section>
<section id="다중공산성-해결-방법" class="level1">
<h1>다중공산성 해결 방법</h1>
<section id="정규화" class="level2">
<h2 class="anchored" data-anchor-id="정규화">정규화</h2>
<div class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>dt2 <span class="ot">&lt;-</span> dt[,<span class="dv">1</span><span class="sc">:</span><span class="dv">19</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="fu">head</span>(dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 6 × 20</caption>
<thead>
    <tr><th></th><th scope="col">승</th><th scope="col">패</th><th scope="col">세</th><th scope="col">홀드</th><th scope="col">블론</th><th scope="col">경기</th><th scope="col">선발</th><th scope="col">이닝</th><th scope="col">삼진.9</th><th scope="col">볼넷.9</th><th scope="col">홈런.9</th><th scope="col">BABIP</th><th scope="col">LOB.</th><th scope="col">ERA</th><th scope="col">RA9.WAR</th><th scope="col">FIP</th><th scope="col">kFIP</th><th scope="col">WAR</th><th scope="col">연봉.2018.</th><th scope="col">연봉.2017.</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>16</td><td> 7</td><td>0</td><td>0</td><td>0</td><td>30</td><td>30</td><td>190.0</td><td>8.95</td><td>2.13</td><td>0.76</td><td>0.342</td><td>73.7</td><td>3.60</td><td>6.91</td><td>3.69</td><td>3.44</td><td>6.62</td><td>140000</td><td> 85000</td></tr>
    <tr><th scope="row">2</th><td>11</td><td>11</td><td>1</td><td>0</td><td>0</td><td>30</td><td>29</td><td>185.1</td><td>7.43</td><td>1.85</td><td>0.53</td><td>0.319</td><td>67.1</td><td>3.88</td><td>6.80</td><td>3.52</td><td>3.41</td><td>6.08</td><td>120000</td><td> 50000</td></tr>
    <tr><th scope="row">3</th><td>20</td><td> 6</td><td>0</td><td>0</td><td>0</td><td>31</td><td>31</td><td>193.1</td><td>7.36</td><td>2.09</td><td>0.79</td><td>0.332</td><td>72.1</td><td>3.44</td><td>6.54</td><td>3.94</td><td>3.82</td><td>5.64</td><td>230000</td><td>150000</td></tr>
    <tr><th scope="row">4</th><td>10</td><td> 7</td><td>0</td><td>0</td><td>0</td><td>28</td><td>28</td><td>175.2</td><td>8.04</td><td>1.95</td><td>1.02</td><td>0.298</td><td>75.0</td><td>3.43</td><td>6.11</td><td>4.20</td><td>4.03</td><td>4.63</td><td>100000</td><td>100000</td></tr>
    <tr><th scope="row">5</th><td>13</td><td> 7</td><td>0</td><td>0</td><td>0</td><td>30</td><td>30</td><td>187.1</td><td>7.49</td><td>2.11</td><td>0.91</td><td>0.323</td><td>74.1</td><td>3.80</td><td>6.13</td><td>4.36</td><td>4.31</td><td>4.38</td><td>111000</td><td> 85000</td></tr>
    <tr><th scope="row">6</th><td> 8</td><td>10</td><td>0</td><td>0</td><td>0</td><td>26</td><td>26</td><td>160.0</td><td>7.42</td><td>1.74</td><td>1.12</td><td>0.289</td><td>76.1</td><td>3.04</td><td>6.52</td><td>4.42</td><td>4.32</td><td>3.94</td><td> 85000</td><td> 35000</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>dt2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 152 × 19</caption>
<thead>
    <tr><th></th><th scope="col">승</th><th scope="col">패</th><th scope="col">세</th><th scope="col">홀드</th><th scope="col">블론</th><th scope="col">경기</th><th scope="col">선발</th><th scope="col">이닝</th><th scope="col">삼진.9</th><th scope="col">볼넷.9</th><th scope="col">홈런.9</th><th scope="col">BABIP</th><th scope="col">LOB.</th><th scope="col">ERA</th><th scope="col">RA9.WAR</th><th scope="col">FIP</th><th scope="col">kFIP</th><th scope="col">WAR</th><th scope="col">연봉.2018.</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;int&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>16</td><td> 7</td><td> 0</td><td> 0</td><td>0</td><td>30</td><td>30</td><td>190.0</td><td> 8.95</td><td>2.13</td><td>0.76</td><td>0.342</td><td>73.7</td><td>3.60</td><td>6.91</td><td>3.69</td><td>3.44</td><td>6.62</td><td>140000</td></tr>
    <tr><th scope="row">2</th><td>11</td><td>11</td><td> 1</td><td> 0</td><td>0</td><td>30</td><td>29</td><td>185.1</td><td> 7.43</td><td>1.85</td><td>0.53</td><td>0.319</td><td>67.1</td><td>3.88</td><td>6.80</td><td>3.52</td><td>3.41</td><td>6.08</td><td>120000</td></tr>
    <tr><th scope="row">3</th><td>20</td><td> 6</td><td> 0</td><td> 0</td><td>0</td><td>31</td><td>31</td><td>193.1</td><td> 7.36</td><td>2.09</td><td>0.79</td><td>0.332</td><td>72.1</td><td>3.44</td><td>6.54</td><td>3.94</td><td>3.82</td><td>5.64</td><td>230000</td></tr>
    <tr><th scope="row">4</th><td>10</td><td> 7</td><td> 0</td><td> 0</td><td>0</td><td>28</td><td>28</td><td>175.2</td><td> 8.04</td><td>1.95</td><td>1.02</td><td>0.298</td><td>75.0</td><td>3.43</td><td>6.11</td><td>4.20</td><td>4.03</td><td>4.63</td><td>100000</td></tr>
    <tr><th scope="row">5</th><td>13</td><td> 7</td><td> 0</td><td> 0</td><td>0</td><td>30</td><td>30</td><td>187.1</td><td> 7.49</td><td>2.11</td><td>0.91</td><td>0.323</td><td>74.1</td><td>3.80</td><td>6.13</td><td>4.36</td><td>4.31</td><td>4.38</td><td>111000</td></tr>
    <tr><th scope="row">6</th><td> 8</td><td>10</td><td> 0</td><td> 0</td><td>0</td><td>26</td><td>26</td><td>160.0</td><td> 7.42</td><td>1.74</td><td>1.12</td><td>0.289</td><td>76.1</td><td>3.04</td><td>6.52</td><td>4.42</td><td>4.32</td><td>3.94</td><td> 85000</td></tr>
    <tr><th scope="row">7</th><td> 8</td><td>12</td><td> 0</td><td> 1</td><td>0</td><td>25</td><td>24</td><td>141.2</td><td> 7.94</td><td>1.02</td><td>0.83</td><td>0.362</td><td>64.6</td><td>5.08</td><td>2.97</td><td>3.88</td><td>3.78</td><td>3.87</td><td> 11500</td></tr>
    <tr><th scope="row">8</th><td>14</td><td> 9</td><td> 0</td><td> 0</td><td>0</td><td>29</td><td>29</td><td>180.1</td><td> 6.24</td><td>2.55</td><td>0.60</td><td>0.293</td><td>75.8</td><td>3.14</td><td>7.28</td><td>4.26</td><td>4.35</td><td>3.85</td><td>100000</td></tr>
    <tr><th scope="row">9</th><td> 9</td><td> 8</td><td> 0</td><td> 2</td><td>0</td><td>35</td><td>24</td><td>137.1</td><td> 9.11</td><td>4.19</td><td>0.52</td><td>0.321</td><td>73.1</td><td>3.67</td><td>4.99</td><td>3.91</td><td>3.67</td><td>3.78</td><td> 16000</td></tr>
    <tr><th scope="row">10</th><td> 9</td><td> 7</td><td> 0</td><td> 0</td><td>0</td><td>30</td><td>29</td><td>176.0</td><td> 7.31</td><td>1.99</td><td>1.12</td><td>0.353</td><td>76.5</td><td>4.14</td><td>5.66</td><td>4.65</td><td>4.61</td><td>3.64</td><td> 70000</td></tr>
    <tr><th scope="row">11</th><td>12</td><td> 9</td><td> 0</td><td> 0</td><td>0</td><td>28</td><td>28</td><td>174.1</td><td> 6.71</td><td>1.91</td><td>1.14</td><td>0.305</td><td>72.7</td><td>4.28</td><td>5.36</td><td>4.78</td><td>4.80</td><td>3.03</td><td> 80000</td></tr>
    <tr><th scope="row">12</th><td>11</td><td> 6</td><td> 0</td><td> 1</td><td>0</td><td>30</td><td>29</td><td>188.2</td><td> 5.06</td><td>1.96</td><td>0.95</td><td>0.329</td><td>69.7</td><td>4.53</td><td>4.79</td><td>4.78</td><td>4.97</td><td>2.89</td><td> 50000</td></tr>
    <tr><th scope="row">13</th><td> 8</td><td> 6</td><td> 0</td><td> 0</td><td>0</td><td>23</td><td>19</td><td>118.1</td><td> 5.55</td><td>1.37</td><td>0.68</td><td>0.331</td><td>72.3</td><td>3.65</td><td>4.25</td><td>4.07</td><td>4.19</td><td>2.79</td><td> 13000</td></tr>
    <tr><th scope="row">14</th><td>12</td><td> 6</td><td> 0</td><td> 0</td><td>0</td><td>28</td><td>28</td><td>171.1</td><td> 6.15</td><td>2.94</td><td>1.10</td><td>0.290</td><td>78.3</td><td>3.68</td><td>5.92</td><td>5.07</td><td>5.14</td><td>2.54</td><td> 25000</td></tr>
    <tr><th scope="row">15</th><td> 8</td><td> 4</td><td> 0</td><td> 3</td><td>0</td><td>35</td><td>14</td><td>100.2</td><td> 8.40</td><td>3.22</td><td>0.98</td><td>0.336</td><td>73.2</td><td>4.38</td><td>3.01</td><td>4.51</td><td>4.34</td><td>2.25</td><td> 15500</td></tr>
    <tr><th scope="row">16</th><td>11</td><td> 5</td><td> 0</td><td> 1</td><td>1</td><td>30</td><td>22</td><td>130.1</td><td> 7.80</td><td>2.83</td><td>1.31</td><td>0.298</td><td>75.8</td><td>4.21</td><td>4.22</td><td>4.91</td><td>4.77</td><td>2.20</td><td> 40000</td></tr>
    <tr><th scope="row">17</th><td> 8</td><td> 6</td><td> 0</td><td> 0</td><td>0</td><td>25</td><td>25</td><td>131.1</td><td> 7.33</td><td>3.77</td><td>0.69</td><td>0.327</td><td>63.5</td><td>5.35</td><td>1.53</td><td>4.79</td><td>4.84</td><td>2.15</td><td> 29000</td></tr>
    <tr><th scope="row">18</th><td> 7</td><td>10</td><td> 0</td><td> 0</td><td>0</td><td>27</td><td>25</td><td>133.0</td><td> 6.77</td><td>1.56</td><td>1.29</td><td>0.334</td><td>60.6</td><td>5.21</td><td>1.48</td><td>4.95</td><td>4.98</td><td>2.14</td><td> 70000</td></tr>
    <tr><th scope="row">19</th><td> 6</td><td>10</td><td> 0</td><td> 0</td><td>0</td><td>27</td><td>26</td><td>124.1</td><td> 8.18</td><td>3.26</td><td>0.87</td><td>0.335</td><td>71.3</td><td>4.63</td><td>3.15</td><td>4.81</td><td>4.79</td><td>2.04</td><td> 11500</td></tr>
    <tr><th scope="row">20</th><td> 1</td><td> 3</td><td>37</td><td> 0</td><td>5</td><td>61</td><td> 0</td><td> 62.0</td><td> 9.00</td><td>1.60</td><td>1.02</td><td>0.311</td><td>89.9</td><td>2.18</td><td>3.91</td><td>3.69</td><td>3.37</td><td>1.82</td><td> 70000</td></tr>
    <tr><th scope="row">21</th><td> 6</td><td> 4</td><td>26</td><td> 0</td><td>5</td><td>56</td><td> 0</td><td> 59.0</td><td>11.90</td><td>2.90</td><td>0.76</td><td>0.304</td><td>79.4</td><td>2.75</td><td>2.85</td><td>3.26</td><td>2.69</td><td>1.81</td><td>120000</td></tr>
    <tr><th scope="row">22</th><td> 6</td><td> 7</td><td> 0</td><td> 0</td><td>0</td><td>23</td><td>22</td><td>120.0</td><td> 6.15</td><td>2.48</td><td>1.20</td><td>0.340</td><td>63.1</td><td>6.00</td><td>1.52</td><td>5.13</td><td>5.22</td><td>1.80</td><td> 13000</td></tr>
    <tr><th scope="row">23</th><td> 3</td><td> 6</td><td> 0</td><td>22</td><td>0</td><td>68</td><td> 0</td><td> 80.0</td><td> 7.76</td><td>2.14</td><td>0.45</td><td>0.336</td><td>63.9</td><td>4.39</td><td>2.02</td><td>3.60</td><td>3.52</td><td>1.71</td><td> 18500</td></tr>
    <tr><th scope="row">24</th><td> 7</td><td> 8</td><td> 0</td><td> 0</td><td>0</td><td>25</td><td>25</td><td>128.0</td><td> 6.05</td><td>2.04</td><td>1.20</td><td>0.328</td><td>66.4</td><td>5.06</td><td>2.47</td><td>5.10</td><td>5.21</td><td>1.68</td><td> 50000</td></tr>
    <tr><th scope="row">25</th><td>12</td><td> 7</td><td> 0</td><td> 1</td><td>0</td><td>29</td><td>28</td><td>151.1</td><td> 6.36</td><td>3.63</td><td>0.95</td><td>0.287</td><td>75.3</td><td>4.10</td><td>4.31</td><td>5.38</td><td>5.55</td><td>1.62</td><td> 20000</td></tr>
    <tr><th scope="row">26</th><td> 4</td><td> 3</td><td> 6</td><td> 4</td><td>1</td><td>70</td><td> 0</td><td> 66.0</td><td> 7.77</td><td>2.18</td><td>0.55</td><td>0.337</td><td>68.0</td><td>3.95</td><td>2.43</td><td>3.57</td><td>3.45</td><td>1.54</td><td> 10000</td></tr>
    <tr><th scope="row">27</th><td>10</td><td> 6</td><td> 0</td><td>15</td><td>2</td><td>69</td><td> 0</td><td> 89.2</td><td> 9.84</td><td>2.71</td><td>1.30</td><td>0.268</td><td>76.1</td><td>3.61</td><td>3.20</td><td>4.30</td><td>3.92</td><td>1.47</td><td> 23000</td></tr>
    <tr><th scope="row">28</th><td> 5</td><td> 1</td><td> 3</td><td> 6</td><td>1</td><td>60</td><td> 3</td><td> 88.2</td><td> 8.73</td><td>3.05</td><td>1.02</td><td>0.312</td><td>71.4</td><td>4.06</td><td>1.97</td><td>4.41</td><td>4.22</td><td>1.38</td><td> 18800</td></tr>
    <tr><th scope="row">29</th><td> 5</td><td> 7</td><td> 0</td><td> 0</td><td>0</td><td>28</td><td>23</td><td>119.0</td><td> 8.85</td><td>3.10</td><td>1.66</td><td>0.350</td><td>65.4</td><td>5.67</td><td>1.04</td><td>5.53</td><td>5.35</td><td>1.31</td><td> 19000</td></tr>
    <tr><th scope="row">30</th><td> 7</td><td> 2</td><td> 7</td><td>12</td><td>1</td><td>70</td><td> 0</td><td> 89.0</td><td> 7.38</td><td>3.24</td><td>0.61</td><td>0.316</td><td>73.5</td><td>3.44</td><td>2.68</td><td>4.15</td><td>4.09</td><td>1.27</td><td> 15000</td></tr>
    <tr><th scope="row">⋮</th><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td><td>⋮</td></tr>
    <tr><th scope="row">123</th><td>0</td><td>2</td><td> 0</td><td> 1</td><td>1</td><td>14</td><td> 0</td><td>21.0</td><td>3.86</td><td>4.71</td><td>0.00</td><td>0.315</td><td>69.2</td><td> 3.43</td><td> 0.12</td><td> 5.16</td><td> 5.73</td><td>-0.12</td><td> 4000</td></tr>
    <tr><th scope="row">124</th><td>0</td><td>0</td><td> 0</td><td> 0</td><td>0</td><td> 4</td><td> 2</td><td> 7.1</td><td>6.14</td><td>7.36</td><td>1.23</td><td>0.613</td><td>50.7</td><td>17.18</td><td>-0.52</td><td> 7.83</td><td> 8.32</td><td>-0.12</td><td> 3600</td></tr>
    <tr><th scope="row">125</th><td>1</td><td>0</td><td> 0</td><td> 0</td><td>0</td><td>24</td><td> 2</td><td>30.0</td><td>5.70</td><td>4.20</td><td>1.80</td><td>0.389</td><td>65.3</td><td> 5.70</td><td>-0.51</td><td> 6.47</td><td> 6.57</td><td>-0.16</td><td> 5200</td></tr>
    <tr><th scope="row">126</th><td>1</td><td>3</td><td> 0</td><td>11</td><td>1</td><td>37</td><td> 0</td><td>31.1</td><td>4.88</td><td>2.59</td><td>1.72</td><td>0.311</td><td>67.3</td><td> 6.32</td><td> 0.04</td><td> 6.48</td><td> 6.78</td><td>-0.16</td><td>45000</td></tr>
    <tr><th scope="row">127</th><td>0</td><td>0</td><td> 0</td><td> 0</td><td>0</td><td>21</td><td> 1</td><td>32.0</td><td>5.91</td><td>6.47</td><td>1.12</td><td>0.378</td><td>59.6</td><td> 8.72</td><td>-0.10</td><td> 6.39</td><td> 6.59</td><td>-0.17</td><td> 3000</td></tr>
    <tr><th scope="row">128</th><td>1</td><td>1</td><td> 0</td><td> 0</td><td>0</td><td>11</td><td> 2</td><td>17.0</td><td>3.71</td><td>5.82</td><td>1.06</td><td>0.300</td><td>53.0</td><td> 7.94</td><td>-0.52</td><td> 6.73</td><td> 7.22</td><td>-0.18</td><td> 9000</td></tr>
    <tr><th scope="row">129</th><td>3</td><td>6</td><td> 0</td><td> 0</td><td>0</td><td>16</td><td>12</td><td>59.0</td><td>4.42</td><td>3.97</td><td>1.83</td><td>0.330</td><td>64.3</td><td> 7.17</td><td> 0.05</td><td> 6.77</td><td> 7.04</td><td>-0.18</td><td> 7300</td></tr>
    <tr><th scope="row">130</th><td>2</td><td>6</td><td> 0</td><td> 0</td><td>1</td><td>14</td><td> 8</td><td>36.1</td><td>5.20</td><td>5.70</td><td>1.24</td><td>0.376</td><td>65.3</td><td> 7.93</td><td>-0.35</td><td> 6.68</td><td> 7.04</td><td>-0.19</td><td> 6000</td></tr>
    <tr><th scope="row">131</th><td>3</td><td>3</td><td> 0</td><td> 0</td><td>0</td><td>20</td><td> 3</td><td>35.2</td><td>6.56</td><td>4.04</td><td>2.02</td><td>0.333</td><td>78.7</td><td> 5.55</td><td> 0.59</td><td> 6.79</td><td> 6.86</td><td>-0.19</td><td> 4200</td></tr>
    <tr><th scope="row">132</th><td>0</td><td>0</td><td> 0</td><td> 0</td><td>0</td><td> 7</td><td> 0</td><td>11.1</td><td>6.35</td><td>5.56</td><td>3.18</td><td>0.361</td><td>68.6</td><td> 9.53</td><td>-0.26</td><td> 9.29</td><td> 9.48</td><td>-0.20</td><td> 2900</td></tr>
    <tr><th scope="row">133</th><td>0</td><td>1</td><td> 0</td><td> 0</td><td>0</td><td>20</td><td> 1</td><td>36.0</td><td>4.00</td><td>5.25</td><td>0.25</td><td>0.381</td><td>67.0</td><td> 6.75</td><td>-0.07</td><td> 5.46</td><td> 5.96</td><td>-0.20</td><td> 6000</td></tr>
    <tr><th scope="row">134</th><td>7</td><td>4</td><td>11</td><td> 6</td><td>6</td><td>65</td><td> 1</td><td>80.1</td><td>7.39</td><td>5.27</td><td>1.12</td><td>0.267</td><td>75.0</td><td> 4.59</td><td> 1.89</td><td> 5.54</td><td> 5.53</td><td>-0.20</td><td>15000</td></tr>
    <tr><th scope="row">135</th><td>1</td><td>4</td><td> 0</td><td> 0</td><td>0</td><td> 9</td><td> 7</td><td>32.0</td><td>7.59</td><td>3.94</td><td>2.53</td><td>0.359</td><td>52.5</td><td> 9.84</td><td>-0.43</td><td> 7.39</td><td> 7.36</td><td>-0.20</td><td> 5700</td></tr>
    <tr><th scope="row">136</th><td>5</td><td>6</td><td> 0</td><td>15</td><td>6</td><td>63</td><td> 0</td><td>73.1</td><td>7.85</td><td>4.05</td><td>1.60</td><td>0.303</td><td>61.0</td><td> 6.63</td><td>-0.74</td><td> 5.68</td><td> 5.59</td><td>-0.22</td><td>24000</td></tr>
    <tr><th scope="row">137</th><td>0</td><td>1</td><td> 0</td><td> 0</td><td>0</td><td> 3</td><td> 1</td><td> 8.0</td><td>4.50</td><td>6.75</td><td>4.50</td><td>0.346</td><td>82.1</td><td> 9.00</td><td>-0.16</td><td>11.48</td><td>11.73</td><td>-0.23</td><td> 3000</td></tr>
    <tr><th scope="row">138</th><td>3</td><td>1</td><td> 0</td><td> 2</td><td>1</td><td>24</td><td> 0</td><td>26.2</td><td>3.71</td><td>2.70</td><td>1.69</td><td>0.307</td><td>71.4</td><td> 5.40</td><td> 0.19</td><td> 6.47</td><td> 6.83</td><td>-0.24</td><td>10000</td></tr>
    <tr><th scope="row">139</th><td>1</td><td>2</td><td> 1</td><td> 5</td><td>2</td><td>35</td><td> 0</td><td>38.0</td><td>7.34</td><td>3.55</td><td>2.13</td><td>0.273</td><td>71.1</td><td> 5.68</td><td>-0.05</td><td> 6.76</td><td> 6.77</td><td>-0.24</td><td> 6500</td></tr>
    <tr><th scope="row">140</th><td>2</td><td>0</td><td> 0</td><td> 0</td><td>0</td><td>16</td><td> 0</td><td>19.0</td><td>4.74</td><td>4.74</td><td>1.42</td><td>0.324</td><td>67.0</td><td> 6.63</td><td>-0.09</td><td> 7.10</td><td> 7.57</td><td>-0.25</td><td> 3200</td></tr>
    <tr><th scope="row">141</th><td>0</td><td>2</td><td> 0</td><td> 1</td><td>0</td><td>37</td><td> 1</td><td>39.0</td><td>5.08</td><td>3.92</td><td>1.62</td><td>0.294</td><td>68.3</td><td> 6.23</td><td> 0.25</td><td> 6.40</td><td> 6.63</td><td>-0.28</td><td> 6800</td></tr>
    <tr><th scope="row">142</th><td>0</td><td>0</td><td> 0</td><td> 0</td><td>0</td><td> 9</td><td> 0</td><td> 8.0</td><td>2.25</td><td>6.75</td><td>3.38</td><td>0.281</td><td>47.3</td><td>10.12</td><td>-0.61</td><td>10.73</td><td>11.37</td><td>-0.30</td><td> 3000</td></tr>
    <tr><th scope="row">143</th><td>4</td><td>3</td><td> 3</td><td> 8</td><td>4</td><td>53</td><td> 0</td><td>53.0</td><td>6.62</td><td>2.38</td><td>2.21</td><td>0.280</td><td>73.9</td><td> 5.09</td><td> 0.28</td><td> 6.30</td><td> 6.27</td><td>-0.38</td><td> 9000</td></tr>
    <tr><th scope="row">144</th><td>5</td><td>3</td><td> 0</td><td> 0</td><td>0</td><td>39</td><td>13</td><td>89.2</td><td>5.12</td><td>3.41</td><td>1.51</td><td>0.320</td><td>57.4</td><td> 7.33</td><td>-0.27</td><td> 6.31</td><td> 6.58</td><td>-0.41</td><td>12500</td></tr>
    <tr><th scope="row">145</th><td>0</td><td>4</td><td> 0</td><td> 0</td><td>0</td><td>15</td><td> 5</td><td>31.0</td><td>4.65</td><td>6.97</td><td>2.03</td><td>0.340</td><td>66.4</td><td> 8.71</td><td>-0.42</td><td> 8.15</td><td> 8.52</td><td>-0.42</td><td> 3600</td></tr>
    <tr><th scope="row">146</th><td>2</td><td>0</td><td> 0</td><td> 0</td><td>0</td><td>30</td><td> 0</td><td>31.2</td><td>7.11</td><td>6.25</td><td>2.56</td><td>0.276</td><td>81.9</td><td> 5.12</td><td> 0.31</td><td> 8.03</td><td> 8.03</td><td>-0.44</td><td> 7000</td></tr>
    <tr><th scope="row">147</th><td>5</td><td>6</td><td> 1</td><td> 3</td><td>2</td><td>39</td><td>12</td><td>81.2</td><td>5.18</td><td>3.42</td><td>1.65</td><td>0.314</td><td>63.2</td><td> 6.61</td><td>-0.02</td><td> 6.33</td><td> 6.54</td><td>-0.46</td><td> 7600</td></tr>
    <tr><th scope="row">148</th><td>2</td><td>5</td><td> 0</td><td> 0</td><td>2</td><td>33</td><td> 5</td><td>62.2</td><td>4.31</td><td>3.30</td><td>1.58</td><td>0.355</td><td>56.9</td><td> 7.76</td><td>-1.21</td><td> 6.21</td><td> 6.48</td><td>-0.47</td><td> 7100</td></tr>
    <tr><th scope="row">149</th><td>3</td><td>2</td><td> 0</td><td> 0</td><td>0</td><td>25</td><td>11</td><td>59.1</td><td>4.85</td><td>5.61</td><td>1.06</td><td>0.263</td><td>65.4</td><td> 5.92</td><td> 0.39</td><td> 6.41</td><td> 6.77</td><td>-0.49</td><td> 7500</td></tr>
    <tr><th scope="row">150</th><td>0</td><td>2</td><td> 0</td><td> 0</td><td>0</td><td> 9</td><td> 2</td><td>14.2</td><td>4.91</td><td>4.91</td><td>2.45</td><td>0.382</td><td>52.8</td><td>11.66</td><td>-0.83</td><td> 8.03</td><td> 8.29</td><td>-0.61</td><td>10000</td></tr>
    <tr><th scope="row">151</th><td>0</td><td>3</td><td> 0</td><td> 1</td><td>0</td><td>41</td><td> 0</td><td>43.2</td><td>7.63</td><td>7.01</td><td>1.44</td><td>0.341</td><td>73.9</td><td> 5.77</td><td>-0.40</td><td> 6.87</td><td> 6.95</td><td>-0.70</td><td> 4000</td></tr>
    <tr><th scope="row">152</th><td>4</td><td>4</td><td> 0</td><td> 0</td><td>0</td><td>24</td><td>14</td><td>81.0</td><td>5.78</td><td>5.89</td><td>2.00</td><td>0.312</td><td>65.3</td><td> 7.67</td><td>-0.68</td><td> 7.60</td><td> 7.81</td><td>-1.01</td><td> 4000</td></tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="변수선택" class="level2">
<h2 class="anchored" data-anchor-id="변수선택">변수선택</h2>
<section id="model3aic" class="level3">
<h3 class="anchored" data-anchor-id="model3aic">model3(AIC)</h3>
<p><code>-</code> AIC(Step)</p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>m0 <span class="ot">=</span> <span class="fu">lm</span>(연봉.<span class="fl">2018.</span> <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-tags="[]" data-execution_count="40">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>model3 <span class="ot">=</span> <span class="fu">step</span>(</span>
<span id="cb31-2"><a href="#cb31-2"></a> m0,</span>
<span id="cb31-3"><a href="#cb31-3"></a> <span class="at">scope =</span> 연봉.<span class="fl">2018.</span> <span class="sc">~</span>연봉.<span class="fl">2017.</span><span class="sc">+</span>승<span class="sc">+</span>패<span class="sc">+</span>세<span class="sc">+</span>홀드<span class="sc">+</span>블론<span class="sc">+</span>경기<span class="sc">+</span>선발<span class="sc">+</span>이닝<span class="sc">+</span>삼진<span class="fl">.9</span><span class="sc">+</span>볼넷<span class="fl">.9</span><span class="sc">+</span>홈런<span class="fl">.9</span><span class="sc">+</span>BABIP<span class="sc">+</span>LOB.<span class="sc">+</span>ERA<span class="sc">+</span>RA9.WAR<span class="sc">+</span>FIP<span class="sc">+</span>kFIP<span class="sc">+</span>WAR,</span>
<span id="cb31-4"><a href="#cb31-4"></a> <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=3144.3
연봉.2018. ~ 1

             Df  Sum of Sq        RSS    AIC
+ 연봉.2017.  1 1.2511e+11 1.9445e+10 2841.4
+ WAR         1 9.0535e+10 5.4022e+10 2996.7
+ RA9.WAR     1 7.9230e+10 6.5326e+10 3025.6
+ 승          1 7.3377e+10 7.1179e+10 3038.6
+ 이닝        1 6.2759e+10 8.1797e+10 3059.8
+ 선발        1 4.5409e+10 9.9147e+10 3089.0
+ 패          1 3.1910e+10 1.1265e+11 3108.4
+ 볼넷.9      1 1.5661e+10 1.2890e+11 3128.9
+ kFIP        1 1.2591e+10 1.3197e+11 3132.4
+ FIP         1 1.1403e+10 1.3315e+11 3133.8
+ ERA         1 6.7332e+09 1.3782e+11 3139.1
+ 세          1 6.4461e+09 1.3811e+11 3139.4
+ 경기        1 6.3714e+09 1.3819e+11 3139.4
+ LOB.        1 2.2831e+09 1.4227e+11 3143.9
+ 홈런.9      1 1.9575e+09 1.4260e+11 3144.2
&lt;none&gt;                     1.4456e+11 3144.3
+ 삼진.9      1 1.5567e+09 1.4300e+11 3144.7
+ BABIP       1 1.5139e+09 1.4304e+11 3144.7
+ 블론        1 1.3815e+09 1.4318e+11 3144.8
+ 홀드        1 4.3499e+07 1.4451e+11 3146.3

Step:  AIC=2841.38
연봉.2018. ~ 연봉.2017.

             Df  Sum of Sq        RSS    AIC
+ WAR         1 7.0421e+09 1.2403e+10 2775.0
+ RA9.WAR     1 4.9589e+09 1.4486e+10 2798.6
+ 승          1 3.8414e+09 1.5604e+10 2809.9
+ 이닝        1 2.8118e+09 1.6633e+10 2819.6
+ 선발        1 2.1318e+09 1.7313e+10 2825.7
+ 패          1 8.8114e+08 1.8564e+10 2836.3
&lt;none&gt;                     1.9445e+10 2841.4
+ 블론        1 2.2022e+08 1.9225e+10 2841.7
+ 세          1 1.7105e+08 1.9274e+10 2842.0
+ kFIP        1 1.6254e+08 1.9283e+10 2842.1
+ FIP         1 1.5483e+08 1.9290e+10 2842.2
+ ERA         1 1.0735e+08 1.9338e+10 2842.5
+ LOB.        1 7.7049e+07 1.9368e+10 2842.8
+ 홈런.9      1 7.3957e+07 1.9371e+10 2842.8
+ 볼넷.9      1 6.4565e+07 1.9381e+10 2842.9
+ BABIP       1 5.6938e+07 1.9388e+10 2842.9
+ 홀드        1 3.8024e+07 1.9407e+10 2843.1
+ 삼진.9      1 5.5081e+06 1.9440e+10 2843.3
+ 경기        1 1.2651e+04 1.9445e+10 2843.4
- 연봉.2017.  1 1.2511e+11 1.4456e+11 3144.3

Step:  AIC=2775.03
연봉.2018. ~ 연봉.2017. + WAR

             Df  Sum of Sq        RSS    AIC
+ 패          1 2.1336e+08 1.2190e+10 2774.4
+ kFIP        1 1.8769e+08 1.2215e+10 2774.7
+ 선발        1 1.7153e+08 1.2232e+10 2774.9
+ FIP         1 1.6877e+08 1.2234e+10 2774.9
+ 볼넷.9      1 1.6419e+08 1.2239e+10 2775.0
&lt;none&gt;                     1.2403e+10 2775.0
+ 이닝        1 1.4704e+08 1.2256e+10 2775.2
+ 홈런.9      1 5.1612e+07 1.2351e+10 2776.4
+ 삼진.9      1 4.8349e+07 1.2355e+10 2776.4
+ 승          1 3.0076e+07 1.2373e+10 2776.7
+ 경기        1 2.7246e+07 1.2376e+10 2776.7
+ BABIP       1 2.4182e+07 1.2379e+10 2776.7
+ ERA         1 1.7077e+07 1.2386e+10 2776.8
+ 블론        1 1.1153e+07 1.2392e+10 2776.9
+ RA9.WAR     1 6.6509e+06 1.2396e+10 2776.9
+ 세          1 4.3325e+06 1.2399e+10 2777.0
+ 홀드        1 3.4824e+06 1.2400e+10 2777.0
+ LOB.        1 6.6018e+05 1.2402e+10 2777.0
- WAR         1 7.0421e+09 1.9445e+10 2841.4
- 연봉.2017.  1 4.1619e+10 5.4022e+10 2996.7

Step:  AIC=2774.4
연봉.2018. ~ 연봉.2017. + WAR + 패

             Df  Sum of Sq        RSS    AIC
+ kFIP        1 1.9738e+08 1.1992e+10 2773.9
+ 승          1 1.8072e+08 1.2009e+10 2774.1
+ FIP         1 1.7496e+08 1.2015e+10 2774.2
&lt;none&gt;                     1.2190e+10 2774.4
- 패          1 2.1336e+08 1.2403e+10 2775.0
+ 볼넷.9      1 1.0330e+08 1.2086e+10 2775.1
+ 홈런.9      1 7.1015e+07 1.2119e+10 2775.5
+ 삼진.9      1 6.6895e+07 1.2123e+10 2775.6
+ 블론        1 4.2173e+07 1.2148e+10 2775.9
+ BABIP       1 4.1954e+07 1.2148e+10 2775.9
+ 선발        1 3.1474e+07 1.2158e+10 2776.0
+ ERA         1 1.3441e+07 1.2176e+10 2776.2
+ 이닝        1 5.8966e+06 1.2184e+10 2776.3
+ 세          1 3.4705e+06 1.2186e+10 2776.3
+ RA9.WAR     1 2.4143e+06 1.2187e+10 2776.4
+ LOB.        1 1.7129e+06 1.2188e+10 2776.4
+ 경기        1 1.1252e+06 1.2189e+10 2776.4
+ 홀드        1 1.8992e+05 1.2190e+10 2776.4
- WAR         1 6.3743e+09 1.8564e+10 2836.3
- 연봉.2017.  1 4.1680e+10 5.3870e+10 2998.3

Step:  AIC=2773.92
연봉.2018. ~ 연봉.2017. + WAR + 패 + kFIP

             Df  Sum of Sq        RSS    AIC
+ 승          1 1.6741e+08 1.1825e+10 2773.8
&lt;none&gt;                     1.1992e+10 2773.9
+ 블론        1 1.2836e+08 1.1864e+10 2774.3
- kFIP        1 1.9738e+08 1.2190e+10 2774.4
+ 선발        1 1.1764e+08 1.1875e+10 2774.4
- 패          1 2.2305e+08 1.2215e+10 2774.7
+ BABIP       1 7.5190e+07 1.1917e+10 2775.0
+ ERA         1 2.1818e+07 1.1971e+10 2775.6
+ 홀드        1 2.1404e+07 1.1971e+10 2775.6
+ 삼진.9      1 1.9275e+07 1.1973e+10 2775.7
+ 경기        1 1.7028e+07 1.1975e+10 2775.7
+ 이닝        1 1.3041e+07 1.1979e+10 2775.8
+ FIP         1 9.3610e+06 1.1983e+10 2775.8
+ 볼넷.9      1 8.8432e+06 1.1983e+10 2775.8
+ 홈런.9      1 8.7223e+06 1.1984e+10 2775.8
+ LOB.        1 4.0316e+06 1.1988e+10 2775.9
+ RA9.WAR     1 2.0131e+06 1.1990e+10 2775.9
+ 세          1 1.4454e+06 1.1991e+10 2775.9
- WAR         1 6.4941e+09 1.8486e+10 2837.7
- 연봉.2017.  1 4.1735e+10 5.3727e+10 2999.9

Step:  AIC=2773.78
연봉.2018. ~ 연봉.2017. + WAR + 패 + kFIP + 승

             Df  Sum of Sq        RSS    AIC
+ 이닝        1 2.1565e+08 1.1609e+10 2773.0
+ 선발        1 1.9668e+08 1.1628e+10 2773.2
&lt;none&gt;                     1.1825e+10 2773.8
- 승          1 1.6741e+08 1.1992e+10 2773.9
- kFIP        1 1.8408e+08 1.2009e+10 2774.1
+ 블론        1 8.3012e+07 1.1742e+10 2774.7
+ RA9.WAR     1 6.3182e+07 1.1762e+10 2775.0
+ BABIP       1 4.5875e+07 1.1779e+10 2775.2
+ 볼넷.9      1 1.7921e+07 1.1807e+10 2775.6
+ 삼진.9      1 1.4564e+07 1.1810e+10 2775.6
+ 홈런.9      1 1.2160e+07 1.1813e+10 2775.6
+ ERA         1 8.8026e+06 1.1816e+10 2775.7
+ FIP         1 8.1221e+06 1.1817e+10 2775.7
+ 세          1 5.8214e+06 1.1819e+10 2775.7
+ 홀드        1 5.2671e+06 1.1820e+10 2775.7
+ LOB.        1 3.9758e+05 1.1825e+10 2775.8
+ 경기        1 3.3176e+05 1.1825e+10 2775.8
- 패          1 3.6648e+08 1.2191e+10 2776.4
- WAR         1 3.6353e+09 1.5460e+10 2812.5
- 연봉.2017.  1 3.9188e+10 5.1013e+10 2994.0

Step:  AIC=2772.98
연봉.2018. ~ 연봉.2017. + WAR + 패 + kFIP + 승 + 이닝

             Df  Sum of Sq        RSS    AIC
- 패          1 3.1923e+07 1.1641e+10 2771.4
&lt;none&gt;                     1.1609e+10 2773.0
- kFIP        1 2.1496e+08 1.1824e+10 2773.8
- 이닝        1 2.1565e+08 1.1825e+10 2773.8
+ BABIP       1 8.7592e+07 1.1522e+10 2773.8
+ 선발        1 5.0414e+07 1.1559e+10 2774.3
+ 블론        1 3.9472e+07 1.1570e+10 2774.5
+ 삼진.9      1 3.3863e+07 1.1575e+10 2774.5
+ ERA         1 3.3525e+07 1.1576e+10 2774.5
+ FIP         1 1.8310e+07 1.1591e+10 2774.7
+ 홈런.9      1 1.2031e+07 1.1597e+10 2774.8
+ RA9.WAR     1 1.0398e+07 1.1599e+10 2774.8
+ LOB.        1 3.1362e+06 1.1606e+10 2774.9
+ 경기        1 1.9500e+06 1.1607e+10 2775.0
+ 볼넷.9      1 1.2880e+06 1.1608e+10 2775.0
+ 세          1 2.2726e+05 1.1609e+10 2775.0
+ 홀드        1 9.3003e+04 1.1609e+10 2775.0
- 승          1 3.7002e+08 1.1979e+10 2775.8
- WAR         1 3.7546e+09 1.5364e+10 2813.6
- 연봉.2017.  1 3.8723e+10 5.0333e+10 2993.9

Step:  AIC=2771.4
연봉.2018. ~ 연봉.2017. + WAR + kFIP + 승 + 이닝

             Df  Sum of Sq        RSS    AIC
&lt;none&gt;                     1.1641e+10 2771.4
+ BABIP       1 9.5915e+07 1.1545e+10 2772.1
- kFIP        1 2.2291e+08 1.1864e+10 2772.3
+ 선발        1 6.0820e+07 1.1580e+10 2772.6
+ ERA         1 4.1760e+07 1.1599e+10 2772.8
+ 삼진.9      1 3.6788e+07 1.1604e+10 2772.9
+ 패          1 3.1923e+07 1.1609e+10 2773.0
+ 블론        1 2.3680e+07 1.1618e+10 2773.1
+ FIP         1 2.0239e+07 1.1621e+10 2773.1
+ 홈런.9      1 1.4166e+07 1.1627e+10 2773.2
+ LOB.        1 7.7349e+06 1.1633e+10 2773.3
+ 경기        1 1.5351e+06 1.1640e+10 2773.4
+ RA9.WAR     1 1.4350e+06 1.1640e+10 2773.4
+ 볼넷.9      1 1.4095e+06 1.1640e+10 2773.4
+ 홀드        1 2.5525e+05 1.1641e+10 2773.4
+ 세          1 6.8181e+04 1.1641e+10 2773.4
- 승          1 4.0011e+08 1.2041e+10 2774.5
- 이닝        1 5.5021e+08 1.2191e+10 2776.4
- WAR         1 3.9604e+09 1.5602e+10 2813.9
- 연봉.2017.  1 3.8795e+10 5.0436e+10 2992.2</code></pre>
</div>
</div>
<section id="summary" class="level4">
<h4 class="anchored" data-anchor-id="summary">summary</h4>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = 연봉.2018. ~ 연봉.2017. + WAR + kFIP + 승 + 
    이닝, data = dt)

Residuals:
   Min     1Q Median     3Q    Max 
-48717  -2879    204   3083  48961 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -2.691e+03  2.658e+03  -1.012  0.31310    
연봉.2017.   8.862e-01  4.018e-02  22.058  &lt; 2e-16 ***
WAR          8.118e+03  1.152e+03   7.048 6.68e-11 ***
kFIP         6.737e+02  4.029e+02   1.672  0.09666 .  
승           1.059e+03  4.727e+02   2.240  0.02659 *  
이닝        -9.701e+01  3.693e+01  -2.627  0.00954 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 8929 on 146 degrees of freedom
Multiple R-squared:  0.9195,    Adjusted R-squared:  0.9167 
F-statistic: 333.4 on 5 and 146 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>AIC를 이용하면 최종 모형은 “연봉.2018. ~ 연봉.2017. + WAR + kFIP+승+이닝” 이다.</li>
</ul>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">vif</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class="dl-inline"><dt>연봉.2017.</dt><dd>1.91752518192932</dd><dt>WAR</dt><dd>4.3927072113068</dd><dt>kFIP</dt><dd>1.20722030237251</dd><dt>승</dt><dd>6.3165168650018</dd><dt>이닝</dt><dd>6.53436057823665</dd></dl>
</div>
</div>
</section>
</section>
</section>
<section id="pca주성분분석" class="level2">
<h2 class="anchored" data-anchor-id="pca주성분분석">PCA(주성분분석)</h2>
<ul>
<li>서로 상관성이 높은 변수들의 선형 결합으로 만들어 기존의 상관성이 높은 변수들을 요약, 축소하는 기법</li>
</ul>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">head</span>(dt, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.frame: 3 × 20</caption>
<thead>
    <tr><th></th><th scope="col">승</th><th scope="col">패</th><th scope="col">세</th><th scope="col">홀드</th><th scope="col">블론</th><th scope="col">경기</th><th scope="col">선발</th><th scope="col">이닝</th><th scope="col">삼진.9</th><th scope="col">볼넷.9</th><th scope="col">홈런.9</th><th scope="col">BABIP</th><th scope="col">LOB.</th><th scope="col">ERA</th><th scope="col">RA9.WAR</th><th scope="col">FIP</th><th scope="col">kFIP</th><th scope="col">WAR</th><th scope="col">연봉.2018.</th><th scope="col">연봉.2017.</th></tr>
    <tr><th></th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;int&gt;</th><th scope="col">&lt;int&gt;</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>16</td><td> 7</td><td>0</td><td>0</td><td>0</td><td>30</td><td>30</td><td>190.0</td><td>8.95</td><td>2.13</td><td>0.76</td><td>0.342</td><td>73.7</td><td>3.60</td><td>6.91</td><td>3.69</td><td>3.44</td><td>6.62</td><td>140000</td><td> 85000</td></tr>
    <tr><th scope="row">2</th><td>11</td><td>11</td><td>1</td><td>0</td><td>0</td><td>30</td><td>29</td><td>185.1</td><td>7.43</td><td>1.85</td><td>0.53</td><td>0.319</td><td>67.1</td><td>3.88</td><td>6.80</td><td>3.52</td><td>3.41</td><td>6.08</td><td>120000</td><td> 50000</td></tr>
    <tr><th scope="row">3</th><td>20</td><td> 6</td><td>0</td><td>0</td><td>0</td><td>31</td><td>31</td><td>193.1</td><td>7.36</td><td>2.09</td><td>0.79</td><td>0.332</td><td>72.1</td><td>3.44</td><td>6.54</td><td>3.94</td><td>3.82</td><td>5.64</td><td>230000</td><td>150000</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>log.dt <span class="ot">&lt;-</span> <span class="fu">log</span>(dt[,<span class="dv">1</span><span class="sc">:</span><span class="dv">18</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning message in FUN(X[[i]], ...):
“NaNs produced”
Warning message in FUN(X[[i]], ...):
“NaNs produced”
Warning message in FUN(X[[i]], ...):
“NaNs produced”</code></pre>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>dt.pca <span class="ot">&lt;-</span> <span class="fu">princomp</span>(dt, <span class="at">cor=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">summary</span>(dt.pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Importance of components:
                         Comp.1    Comp.2    Comp.3     Comp.4     Comp.5
Standard deviation     2.713772 1.8768322 1.5635037 1.27736597 1.12734803
Proportion of Variance 0.368228 0.1761249 0.1222272 0.08158319 0.06354568
Cumulative Proportion  0.368228 0.5443530 0.6665801 0.74816334 0.81170902
                           Comp.6     Comp.7     Comp.8     Comp.9   Comp.10
Standard deviation     0.95298765 0.85055438 0.77308613 0.61480657 0.5714560
Proportion of Variance 0.04540927 0.03617214 0.02988311 0.01889936 0.0163281
Cumulative Proportion  0.85711829 0.89329043 0.92317354 0.94207289 0.9584010
                          Comp.11     Comp.12     Comp.13     Comp.14
Standard deviation     0.51349415 0.437212718 0.322182613 0.292730349
Proportion of Variance 0.01318381 0.009557748 0.005190082 0.004284553
Cumulative Proportion  0.97158481 0.981142554 0.986332636 0.990617188
                           Comp.15     Comp.16     Comp.17      Comp.18
Standard deviation     0.270420989 0.221137542 0.200900792 0.1231832080
Proportion of Variance 0.003656376 0.002445091 0.002018056 0.0007587051
Cumulative Proportion  0.994273564 0.996718655 0.998736711 0.9994954162
                            Comp.19      Comp.20
Standard deviation     0.1002308794 6.741405e-03
Proportion of Variance 0.0005023115 2.272327e-06
Cumulative Proportion  0.9999977277 1.000000e+00</code></pre>
</div>
</div>
<ul>
<li>제 1주성분과 제6주성분까지의 누적 분산비율은 대략 85.71%로 6개의 주성분 변수를 활용해 전체 데이터의 85.71%를 설명할 수 있다.</li>
</ul>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">screeplot</span>(dt.pca, <span class="at">npcs=</span><span class="dv">8</span>, <span class="at">type=</span><span class="st">"lines"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="AS4_5_files/figure-html/cell-44-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>주성분들에 의해 설명되는 변동 비율</li>
</ul>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">loadings</span>(dt.pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Loadings:
           Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9
승          0.317  0.170                                            0.103
패          0.263  0.164         0.106  0.312        -0.335  0.138 -0.402
세                -0.190  0.302  0.127 -0.455 -0.296 -0.438         0.326
홀드              -0.251  0.338  0.140  0.369  0.228  0.453         0.105
블론              -0.264  0.406  0.204        -0.172 -0.165  0.160 -0.333
경기        0.174 -0.228  0.368  0.220  0.241                       0.214
선발        0.259  0.312 -0.151         0.138        -0.231        -0.138
이닝        0.321  0.198                0.183        -0.136              
삼진.9                    0.390 -0.404 -0.124  0.508 -0.157 -0.113 -0.268
볼넷.9     -0.232  0.142               -0.212  0.308         0.771       
홈런.9     -0.152  0.304  0.268  0.267         0.177        -0.526       
BABIP      -0.125  0.224  0.286 -0.444                              0.179
LOB.        0.117 -0.219 -0.220  0.230 -0.335  0.559 -0.118 -0.142       
ERA        -0.210  0.318  0.281 -0.157        -0.139                0.123
RA9.WAR     0.322  0.147               -0.106  0.163                0.440
FIP        -0.235  0.306         0.378                                   
kFIP       -0.234  0.288         0.423                                   
WAR         0.317  0.186                                            0.287
연봉.2018.  0.284  0.158               -0.327 -0.130  0.397        -0.152
연봉.2017.  0.263  0.129  0.106        -0.358 -0.204  0.414        -0.315
           Comp.10 Comp.11 Comp.12 Comp.13 Comp.14 Comp.15 Comp.16 Comp.17
승                  0.386   0.237   0.472   0.592   0.142           0.107 
패                 -0.482  -0.139  -0.117   0.314  -0.239   0.233  -0.110 
세         -0.158  -0.338           0.231           0.199  -0.118         
홀드        0.126  -0.336  -0.331   0.286           0.225  -0.105         
블론        0.384   0.520  -0.251  -0.124  -0.149                         
경기       -0.197           0.555  -0.333          -0.241                 
선발                                0.205  -0.420   0.277  -0.322         
이닝                        0.212          -0.350          -0.218         
삼진.9     -0.370                                                         
볼넷.9     -0.102           0.129                                         
홈런.9                                                                    
BABIP       0.655  -0.181   0.294  -0.157           0.192                 
LOB.        0.413  -0.160                          -0.336  -0.169   0.133 
ERA                        -0.140   0.334          -0.688  -0.246   0.174 
RA9.WAR             0.117  -0.242          -0.263  -0.172   0.490  -0.464 
FIP                                                 0.105                 
kFIP                                                                      
WAR                        -0.397  -0.494   0.169          -0.104   0.551 
연봉.2018.                         -0.158   0.211          -0.490  -0.515 
연봉.2017.         -0.170   0.199   0.148  -0.250           0.413   0.359 
           Comp.18 Comp.19 Comp.20
승                                
패                                
세                                
홀드                              
블론                              
경기                0.320         
선발                0.556         
이닝               -0.755         
삼진.9     -0.377                 
볼넷.9      0.359                 
홈런.9      0.614          -0.125 
BABIP                             
LOB.                              
ERA                               
RA9.WAR                           
FIP        -0.322           0.754 
kFIP       -0.491          -0.641 
WAR                               
연봉.2018.                        
연봉.2017.                        

               Comp.1 Comp.2 Comp.3 Comp.4 Comp.5 Comp.6 Comp.7 Comp.8 Comp.9
SS loadings      1.00   1.00   1.00   1.00   1.00   1.00   1.00   1.00   1.00
Proportion Var   0.05   0.05   0.05   0.05   0.05   0.05   0.05   0.05   0.05
Cumulative Var   0.05   0.10   0.15   0.20   0.25   0.30   0.35   0.40   0.45
               Comp.10 Comp.11 Comp.12 Comp.13 Comp.14 Comp.15 Comp.16 Comp.17
SS loadings       1.00    1.00    1.00    1.00    1.00    1.00    1.00    1.00
Proportion Var    0.05    0.05    0.05    0.05    0.05    0.05    0.05    0.05
Cumulative Var    0.50    0.55    0.60    0.65    0.70    0.75    0.80    0.85
               Comp.18 Comp.19 Comp.20
SS loadings       1.00    1.00    1.00
Proportion Var    0.05    0.05    0.05
Cumulative Var    0.90    0.95    1.00</code></pre>
</div>
</div>
</section>
</section>
<section id="해볼것" class="level1">
<h1>해볼것</h1>
<ul>
<li><p>변수에서 이상치 있는 변수들 제거 하고 또다른 model2를 만들어서 돌려보자</p></li>
<li><p>다중곤산성이 있으니까 능형회귀추정량을 돌려보자.</p></li>
</ul>
</section>
<section id="능형회귀" class="level1">
<h1>능형회귀</h1>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>rfit <span class="ot">&lt;-</span> <span class="fu">lm.ridge</span>(연봉.<span class="fl">2018.</span><span class="sc">~</span>., dt, <span class="at">lambda=</span><span class="fu">seq</span>(<span class="fl">0.01</span>,<span class="dv">20</span>,<span class="fl">0.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">select</span>(rfit) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>modified HKB estimator is 1.552458 
modified L-W estimator is 1.638756 
smallest value of GCV  at 4.11 </code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">round</span>(rfit<span class="sc">$</span>coef[,rfit<span class="sc">$</span>lam<span class="sc">==</span><span class="st">'4.11'</span>],<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class="dl-inline"><dt>승</dt><dd>3659.317</dd><dt>패</dt><dd>-737.614</dd><dt>세</dt><dd>-93.401</dd><dt>홀드</dt><dd>-155.777</dd><dt>블론</dt><dd>859.526</dd><dt>경기</dt><dd>-1932.839</dd><dt>선발</dt><dd>-3234.453</dd><dt>이닝</dt><dd>441.579</dd><dt>삼진.9</dt><dd>-934.786</dd><dt>볼넷.9</dt><dd>1047.402</dd><dt>홈런.9</dt><dd>1328.778</dd><dt>BABIP</dt><dd>-755.31</dd><dt>LOB.</dt><dd>-578.691</dd><dt>ERA</dt><dd>-288.368</dd><dt>RA9.WAR</dt><dd>516.127</dd><dt>FIP</dt><dd>-176.744</dd><dt>kFIP</dt><dd>-420.71</dd><dt>WAR</dt><dd>9904.312</dd><dt>연봉.2017.</dt><dd>21113.076</dd></dl>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">matplot</span>(rfit<span class="sc">$</span>lambda, <span class="fu">t</span>(rfit<span class="sc">$</span>coef), <span class="at">type=</span><span class="st">'l'</span>,</span>
<span id="cb49-2"><a href="#cb49-2"></a>        <span class="at">xlab=</span><span class="fu">expression</span>(lambda),</span>
<span id="cb49-3"><a href="#cb49-3"></a>        <span class="at">ylab=</span><span class="fu">expression</span>(<span class="fu">bold</span>(beta)(lambda)), <span class="at">lwd=</span><span class="dv">2</span>) </span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"grey"</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fl">14.91</span>, <span class="at">col=</span><span class="st">"black"</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="AS4_5_files/figure-html/cell-51-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="glm" class="level2">
<h2 class="anchored" data-anchor-id="glm">glm</h2>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a></span>
<span id="cb50-2"><a href="#cb50-2"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(연봉.<span class="fl">2018.</span><span class="sc">~</span>., dt)[,<span class="sc">-</span><span class="dv">1</span>] </span>
<span id="cb50-3"><a href="#cb50-3"></a>y <span class="ot">&lt;-</span> dt<span class="sc">$</span>연봉.<span class="fl">2018.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">head</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A matrix: 6 × 19 of type dbl</caption>
<thead>
    <tr><th></th><th scope="col">승</th><th scope="col">패</th><th scope="col">세</th><th scope="col">홀드</th><th scope="col">블론</th><th scope="col">경기</th><th scope="col">선발</th><th scope="col">이닝</th><th scope="col">삼진.9</th><th scope="col">볼넷.9</th><th scope="col">홈런.9</th><th scope="col">BABIP</th><th scope="col">LOB.</th><th scope="col">ERA</th><th scope="col">RA9.WAR</th><th scope="col">FIP</th><th scope="col">kFIP</th><th scope="col">WAR</th><th scope="col">연봉.2017.</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1</th><td>16</td><td> 7</td><td>0</td><td>0</td><td>0</td><td>30</td><td>30</td><td>190.0</td><td>8.95</td><td>2.13</td><td>0.76</td><td>0.342</td><td>73.7</td><td>3.60</td><td>6.91</td><td>3.69</td><td>3.44</td><td>6.62</td><td> 85000</td></tr>
    <tr><th scope="row">2</th><td>11</td><td>11</td><td>1</td><td>0</td><td>0</td><td>30</td><td>29</td><td>185.1</td><td>7.43</td><td>1.85</td><td>0.53</td><td>0.319</td><td>67.1</td><td>3.88</td><td>6.80</td><td>3.52</td><td>3.41</td><td>6.08</td><td> 50000</td></tr>
    <tr><th scope="row">3</th><td>20</td><td> 6</td><td>0</td><td>0</td><td>0</td><td>31</td><td>31</td><td>193.1</td><td>7.36</td><td>2.09</td><td>0.79</td><td>0.332</td><td>72.1</td><td>3.44</td><td>6.54</td><td>3.94</td><td>3.82</td><td>5.64</td><td>150000</td></tr>
    <tr><th scope="row">4</th><td>10</td><td> 7</td><td>0</td><td>0</td><td>0</td><td>28</td><td>28</td><td>175.2</td><td>8.04</td><td>1.95</td><td>1.02</td><td>0.298</td><td>75.0</td><td>3.43</td><td>6.11</td><td>4.20</td><td>4.03</td><td>4.63</td><td>100000</td></tr>
    <tr><th scope="row">5</th><td>13</td><td> 7</td><td>0</td><td>0</td><td>0</td><td>30</td><td>30</td><td>187.1</td><td>7.49</td><td>2.11</td><td>0.91</td><td>0.323</td><td>74.1</td><td>3.80</td><td>6.13</td><td>4.36</td><td>4.31</td><td>4.38</td><td> 85000</td></tr>
    <tr><th scope="row">6</th><td> 8</td><td>10</td><td>0</td><td>0</td><td>0</td><td>26</td><td>26</td><td>160.0</td><td>7.42</td><td>1.74</td><td>1.12</td><td>0.289</td><td>76.1</td><td>3.04</td><td>6.52</td><td>4.42</td><td>4.32</td><td>3.94</td><td> 35000</td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>ridge.fit<span class="ot">&lt;-</span><span class="fu">glmnet</span>(X,y,<span class="at">alpha=</span><span class="dv">0</span>, <span class="at">lambda=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">10</span>)) <span class="do">##ridge : alpha=0 </span></span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="fu">plot</span>(ridge.fit, <span class="at">label=</span><span class="cn">TRUE</span>)</span>
<span id="cb52-3"><a href="#cb52-3"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"grey"</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="AS4_5_files/figure-html/cell-54-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>cv.fit<span class="ot">&lt;-</span><span class="fu">cv.glmnet</span>(X,y,<span class="at">alpha=</span><span class="dv">0</span>,<span class="at">nfolds=</span><span class="fu">length</span>(y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning message:
“Option grouped=FALSE enforced in cv.glmnet, since &lt; 3 observations per fold”</code></pre>
</div>
</div>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>cv.fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:  cv.glmnet(x = X, y = y, nfolds = length(y), alpha = 0) 

Measure: Mean-Squared Error 

    Lambda Index   Measure       SE Nonzero
min   2869   100 117171048 49876335      19
1se  12711    84 166795504 78214517      19</code></pre>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">plot</span>(cv.fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="AS4_5_files/figure-html/cell-57-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="번외-war을-y로" class="level1">
<h1>번외 (WAR을 y로)</h1>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>model_ <span class="ot">&lt;-</span> <span class="fu">lm</span>(WAR <span class="sc">~</span> ., dt)</span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="fu">summary</span>(model_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Call:
lm(formula = WAR ~ ., data = dt)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.25837 -0.18387 -0.00443  0.17470  1.58012 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8.632e-01  8.184e-01   1.055   0.2935    
승           7.000e-04  2.446e-02   0.029   0.9772    
패           3.924e-02  2.449e-02   1.602   0.1115    
세           1.444e-03  1.218e-02   0.119   0.9058    
홀드         1.016e-02  1.417e-02   0.717   0.4747    
블론        -5.186e-02  3.392e-02  -1.529   0.1287    
경기        -1.216e-02  6.489e-03  -1.874   0.0631 .  
선발        -2.104e-02  2.081e-02  -1.011   0.3139    
이닝         7.125e-03  5.161e-03   1.381   0.1698    
삼진.9       2.483e-02  1.055e-01   0.235   0.8142    
볼넷.9       1.254e-02  1.014e-01   0.124   0.9017    
홈런.9      -3.549e-03  6.346e-01  -0.006   0.9955    
BABIP        9.050e-01  6.636e-01   1.364   0.1749    
LOB.        -1.276e-02  5.728e-03  -2.227   0.0277 *  
ERA         -3.164e-02  2.542e-02  -1.245   0.2154    
RA9.WAR      4.259e-01  5.563e-02   7.655 3.63e-12 ***
FIP         -2.926e-02  2.011e+00  -0.015   0.9884    
kFIP        -2.821e-02  1.613e+00  -0.017   0.9861    
연봉.2018.   1.726e-05  3.608e-06   4.783 4.55e-06 ***
연봉.2017.  -9.617e-06  3.872e-06  -2.484   0.0143 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.413 on 132 degrees of freedom
Multiple R-squared:  0.9147,    Adjusted R-squared:  0.9024 
F-statistic:  74.5 on 19 and 132 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">vif</span>(model_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class="dl-inline"><dt>승</dt><dd>7.90295946436358</dd><dt>패</dt><dd>5.20359428014936</dd><dt>세</dt><dd>3.03700161686166</dd><dt>홀드</dt><dd>3.62204119070403</dd><dt>블론</dt><dd>2.71884077341546</dd><dt>경기</dt><dd>13.9861481235494</dd><dt>선발</dt><dd>36.4583393437946</dd><dt>이닝</dt><dd>59.6518045536892</dd><dt>삼진.9</dt><dd>78.7060221382132</dd><dt>볼넷.9</dt><dd>50.827473231967</dd><dt>홈런.9</dt><dd>368.731473825923</dd><dt>BABIP</dt><dd>3.08657710689315</dd><dt>LOB.</dt><dd>3.90285091455909</dd><dt>ERA</dt><dd>9.92892504247788</dd><dt>RA9.WAR</dt><dd>9.3121534743985</dd><dt>FIP</dt><dd>12527.1829610516</dd><dt>kFIP</dt><dd>9046.79675541892</dd><dt>연봉.2018.</dt><dd>11.0333055183751</dd><dt>연봉.2017.</dt><dd>8.32457422928209</dd></dl>
</div>
</div>
<ul>
<li>WAR로 돌린 모델의 <span class="math inline">\(R^2\)</span>값이 연봉으로 돌린 것보다 높게 나왔다.</li>
</ul>
</section>
<section id="feedback" class="level1">
<h1>feedback</h1>
<ul>
<li><p>WAR이 설명변수의 곱으로 이루어진 변수라 WAR이 들어가면 다른 설명변수를 빼는게 좋다.</p></li>
<li><p>y로 잡은 연봉과 설명변수의 상관관계보다 WAR이 상관관계가 더 높다? WAR을 y로 잡고 연봉이 WAR에 영향을 주는지 확인해 보는게 더 좋았을듯.</p></li>
<li><p>2017년 연봉과 2018년 연봉을 비교해 보는 것도 좋았을 거 같다.</p></li>
<li><p>팀명은 범주형 변수로 굳이 어울리진 않는듯! 생각해보니 팀마다 잘하는 투수도 있고 그럭저럭한 선수들도 있을테니..</p></li>
<li><p>이상치 영향점 레버리지 포인트에 해당되는 변수를 제외하고 돌려보자~</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>